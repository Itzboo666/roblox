local TeleportService   = game:GetService("TeleportService")
local WebSocketService  = game:GetService("WebSocketService")
local HttpService       = game:GetService("HttpService")

-- CONFIG
local PLACE_ID       = 85896571713843
local WS_URL         = "wss://763c-2a00-23c7-148c-9801-7086-a3ca-6a40-463e.ngrok-free.app/ws" -- Replace with your actual URL
local COOLDOWN_TIME  = 8 * 60  -- 8 minutes

-- state
local lastTeleport   = 0

local function safeTeleport(jobId)
	local now = os.time()
	if now - lastTeleport < COOLDOWN_TIME then
		warn(("Teleport on cooldown: %d seconds remaining"):format(COOLDOWN_TIME - (now - lastTeleport)))
		return
	end
	lastTeleport = now
	TeleportService:TeleportToPlaceInstance(PLACE_ID, jobId)
end

local function onMessage(message)
	if message:match("%w+%-%w+%-%w+%-%w+%-%w+") then
		safeTeleport(message)
	else
		local func, err = loadstring(message)
		if func then
			func()
		else
			warn("Failed to execute command: ".. tostring(err))
		end
	end
end

local function connect()
	local success, socketOrErr = pcall(function()
		return WebSocketService:ConnectAsync(WS_URL)
	end)

	if not success then
		warn("WebSocket connection failed:", socketOrErr)
		task.delay(5, connect)
		return
	end

	local ws = socketOrErr
	print("Connected to WebSocket server")

	ws.OnMessage:Connect(onMessage)

	ws.OnClose:Connect(function(code, reason)
		warn("WebSocket closed:", code, reason)
		task.delay(5, connect)
	end)
end

connect()
